<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/tabs"></ion-back-button>
    </ion-buttons>
    <ion-title>Ajukan Cuti Baru</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">

  <form (ngSubmit)="onSubmit()">
    
    <!-- Jenis Cuti -->
    <ion-item 
      class="ion-margin-bottom rounded-item clickable-item" 
      lines="none"
      (click)="openLeaveTypeSelector()"
      button
      detail="false">
      <ion-label position="stacked">Jenis Cuti</ion-label>
      <ion-text [color]="leaveType ? 'dark' : 'medium'" class="item-value">
        {{ leaveTypeLabel }}
      </ion-text>
    </ion-item>

    <!-- Tanggal Mulai & Selesai -->
    <ion-row>
      <ion-col size="6">
        <ion-item 
          class="rounded-item clickable-item" 
          lines="none"
          button
          detail="false"
          (click)="openStartDatePicker()">
          <div class="w-100">
            <ion-label position="stacked" color="medium">Mulai</ion-label>
            <ion-text color="dark" class="date-display">
              {{ formatDate(startDate) }}
            </ion-text>
          </div>
        </ion-item>
      </ion-col>
      
      <ion-col size="6">
        <ion-item 
          class="rounded-item clickable-item" 
          lines="none"
          button
          detail="false"
          (click)="openEndDatePicker()">
          <div class="w-100">
            <ion-label position="stacked" color="medium">Selesai</ion-label>
            <ion-text color="dark" class="date-display">
              {{ formatDate(endDate) }}
            </ion-text>
          </div>
        </ion-item>
      </ion-col>
    </ion-row>

    <!-- Alasan Cuti -->
    <ion-item 
      class="ion-margin-top rounded-item clickable-item" 
      lines="none"
      button
      detail="false"
      (click)="openReasonInput()">
      <ion-label position="stacked">Alasan Cuti</ion-label>
      <ion-text [color]="reason ? 'dark' : 'medium'" class="reason-text">
        {{ reason || 'Ketuk untuk menulis alasan...' }}
      </ion-text>
    </ion-item>

    <!-- Camera Section -->
    <div *ngIf="leaveType === 'Sakit'" class="ion-margin-top camera-section">
      <ion-label color="danger" class="ion-margin-bottom d-block">
        * Wajib lampirkan foto surat dokter
      </ion-label>
      
      <app-camera-view (photoTaken)="handleAttachment($event)"></app-camera-view>
    </div>

    <!-- Submit Button -->
    <ion-button 
      expand="block" 
      type="submit" 
      class="ion-margin-top submit-button" 
      size="large" 
      [disabled]="isSubmitting">
      <span *ngIf="!isSubmitting">Kirim Pengajuan</span>
      <ion-spinner *ngIf="isSubmitting" name="crescent"></ion-spinner>
    </ion-button>

  </form>

</ion-content>