<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/tabs/driver/attendance"></ion-back-button>
    </ion-buttons>
    <ion-title>Daftar Pelanggan</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding-top">
  
  <ion-refresher slot="fixed" (ionRefresh)="loadData($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <ion-list *ngIf="isLoading">
    <ion-item *ngFor="let i of [1,2,3,4,5]">
      <ion-label>
        <h3><ion-skeleton-text animated style="width: 60%"></ion-skeleton-text></h3>
        <p><ion-skeleton-text animated style="width: 80%"></ion-skeleton-text></p>
      </ion-label>
    </ion-item>
  </ion-list>

  <ion-list *ngIf="!isLoading">
    <ion-item *ngFor="let item of customers" lines="full">
      
      <ion-label class="ion-text-wrap">
        <h2 style="font-weight: bold; font-size: 1.1rem; color: var(--ion-color-dark);">
          {{ item.name }}
        </h2>
        
        <p style="display: flex; align-items: flex-start; gap: 6px; margin-top: 6px; color: gray;">
          <ion-icon name="location-outline" style="min-width: 16px; margin-top: 2px;"></ion-icon> 
          <span>{{ item.address }}</span>
        </p>

        <p *ngIf="item.phone" (click)="callCustomer(item.phone)" style="display: flex; align-items: center; gap: 6px; margin-top: 6px; color: var(--ion-color-primary);">
          <ion-icon name="call-outline"></ion-icon>
          <span>{{ item.phone }}</span>
        </p>
      </ion-label>

      <div slot="end" (click)="openMap(item.google_maps_link)" style="z-index: 10;">
        <div style="
          background: #e8f5e9; 
          color: #2e7d32; 
          width: 45px;
          height: 45px;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
          cursor: pointer;">
          <ion-icon name="map-outline" size="large"></ion-icon>
        </div>
        <div style="font-size: 10px; text-align: center; color: #2e7d32; margin-top: 4px; font-weight: 600;">Maps</div>
      </div>

    </ion-item>
  </ion-list>

  <div *ngIf="!isLoading && customers.length === 0" class="ion-text-center ion-padding" style="margin-top: 50px;">
    <ion-icon name="map-outline" style="font-size: 64px; color: #ccc;"></ion-icon>
    <p style="color: gray; margin-top: 10px;">Belum ada data pelanggan.</p>
  </div>

</ion-content>